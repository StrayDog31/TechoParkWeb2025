{% load static %}
<style>
  .question-card {
    transition: transform 0.2s;
  }
  .question-card:hover {
      transform: translateY(-2px);
  }
  .user-img {
    width: 80px;
    height: 80px;
    object-fit: cover;
    object-position: top;
    border-radius: 5%;
  }
  .count {
    font-size: 0.75rem;
    margin-top: 0.2rem;
  }
  .rating-container {
    display: flex;
    align-items: center;
    justify-content: center;
    gap: 10px;
  }
  .rating-value {
    font-weight: bold;
    min-width: 20px;
    text-align: center;
  }
  .author-info {
    margin-top: 5px;
    font-size: 0.85rem;
  }
</style>

<div class="card mb-3 question-card">
  <div class="card-body">
    <div class="row">
      <div class="col-2 text-center">
        <div class="mb-2">
            {% if question.author.profile.avatar %}
                <img src="{{ question.author.profile.avatar.url }}" 
                 alt="{{ question.author.username }}" 
                 class="user-img"
                 onerror="this.onerror=null; this.src='{% static 'images/default_avatar.png' %}'">
            {% else %}
                <img src="{% static 'images/default_avatar.png' %}" 
                     alt="{{ question.author.username }}" 
                     class="user-img">
            {% endif %}
        </div>
        <div class="rating-container">
            <div class="d-flex flex-row align-items-center">
                <button class="btn btn-sm like-btn 
                    {% if question.current_user_vote == 'like' %}
                        btn-success
                    {% else %}
                        btn-outline-success
                    {% endif %}"
                    data-question-id="{{ question.id }}">
                    <i class="bi bi-arrow-up"></i>
                </button>

                <div class="question-rating mx-2" data-question-id="{{ question.id }}">
                    {{ question.rating }}
                </div>

                <button class="btn btn-sm dislike-btn 
                    {% if question.current_user_vote == 'dislike' %}
                        btn-danger
                    {% else %}
                        btn-outline-danger
                    {% endif %}"
                    data-question-id="{{ question.id }}">
                    <i class="bi bi-arrow-down"></i>
                </button>
            </div>
        </div>
        <div class="author-info">
          <a href="#" class="text-decoration-none text-dark">
            {{ question.author.username }}
          </a>
        </div>
      </div>
      
      <div class="col-10">
        <h5 class="card-title">
          <a href="{% url 'single_question' question.id %}" class="text-decoration-none text-dark">
            {{ question.title }}
          </a>
        </h5>
        <p class="card-text text-muted">{{ question.text|truncatechars:200 }}</p>
        <div class="d-flex justify-content-between align-items-center">
          <a href="{% url 'single_question' question.id %}" class="btn btn-outline-dark btn-sm">
            Answers ({{ question.get_answers_count }})
          </a>
          <div class="text-muted small">
            <span>Tags:</span>
            {% for tag in question.tags.all %}
              <a href="{% url 'search_tag' tag.name %}" class="badge bg-warning text-white ms-1">
                {{ tag.name }}
              </a>
            {% endfor %}
          </div>
          <div class="text-muted small">
            Asked {{ question.created_at|timesince }} ago
          </div>
        </div>
      </div>
    </div>
  </div>
</div>